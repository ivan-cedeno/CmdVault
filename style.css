/* --- MATERIAL DESIGN 3 EXPRESSIVE THEME SYSTEM --- */
@import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=JetBrains+Mono:wght@400;500&display=swap');

/* 1. VARIABLES ESTRUCTURALES */
:root {
    --font-ui: 'Roboto', sans-serif;
    --font-code: 'JetBrains Mono', 'Consolas', monospace;
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-pill: 50px;
}

/* =========================================
   LAYOUT
   ========================================= */
html, body {
    height: 100%; width: 100%; margin: 0; padding: 0;
    overflow: hidden; display: flex; flex-direction: column;
}

.top-bar {
    flex: 0 0 auto; width: 100%; z-index: 10;
    background-color: var(--md-sys-color-background);
    padding: 10px 16px; box-sizing: border-box;
    border-bottom: 1px solid var(--md-sys-color-surface-container-high);
}

.main-content {
    flex: 1; min-height: 0; overflow-y: auto; overflow-x: hidden;
    padding: 10px 16px 20px 16px;
}

/* SCROLLBAR */
::-webkit-scrollbar { width: 8px; }
::-webkit-scrollbar-track { background: rgba(128, 128, 128, 0.05); }
::-webkit-scrollbar-thumb {
    background-color: var(--md-sys-color-outline);
    border-radius: 10px; border: 2px solid transparent; background-clip: content-box;
}
::-webkit-scrollbar-thumb:hover { background-color: var(--md-sys-color-primary); }

/* =========================================
   TEMAS
   ========================================= */
body.theme-dark {
    --md-sys-color-background: #141218; --md-sys-color-surface: #1D1B20;
    --md-sys-color-surface-container: #211F26; --md-sys-color-surface-container-high: #2B2930;
    --md-sys-color-primary: #D0BCFF; --md-sys-color-on-primary: #381E72;
    --md-sys-color-secondary-container: #4A4458; --md-sys-color-on-surface: #E6E1E5;
    --md-sys-color-on-surface-variant: #CAC4D0; --md-sys-color-outline: #938F99;
    --md-sys-color-error: #F2B8B5; --cmd-bg: #2b2d31; --accent-green: #B7F397;
    --selection-bg: rgba(208, 188, 255, 0.2);
}
body.theme-light {
    --md-sys-color-background: #F9F9F9; --md-sys-color-surface: #FFFFFF;
    --md-sys-color-surface-container: #F0F0F0; --md-sys-color-surface-container-high: #E8E8E8;
    --md-sys-color-primary: #6750A4; --md-sys-color-on-primary: #FFFFFF;
    --md-sys-color-secondary-container: #E8DEF8; --md-sys-color-on-surface: #1C1B1F;
    --md-sys-color-on-surface-variant: #49454F; --md-sys-color-outline: #79747E;
    --md-sys-color-error: #B3261E; --cmd-bg: #EFEFEF; --accent-green: #468b24;
    --selection-bg: rgba(103, 80, 164, 0.1);
}
body.theme-hacker {
    --md-sys-color-background: #000000; --md-sys-color-surface: #0a0a0a;
    --md-sys-color-surface-container: #111; --md-sys-color-surface-container-high: #1a1a1a;
    --md-sys-color-primary: #00FF00; --md-sys-color-on-primary: #000000;
    --md-sys-color-secondary-container: #003300; --md-sys-color-on-surface: #00FF00;
    --md-sys-color-on-surface-variant: #00cc00; --md-sys-color-outline: #005500;
    --md-sys-color-error: #FF0000; --cmd-bg: #050505; --accent-green: #00FF00;
    --selection-bg: rgba(0, 255, 0, 0.15);
}
body.theme-ocean {
    --md-sys-color-background: #0f172a; --md-sys-color-surface: #1e293b;
    --md-sys-color-surface-container: #334155; --md-sys-color-surface-container-high: #475569;
    --md-sys-color-primary: #38bdf8; --md-sys-color-on-primary: #0f172a;
    --md-sys-color-secondary-container: #1e3a8a; --md-sys-color-on-surface: #f1f5f9;
    --md-sys-color-on-surface-variant: #cbd5e1; --md-sys-color-outline: #64748b;
    --md-sys-color-error: #f87171; --cmd-bg: #1e293b; --accent-green: #4ade80;
    --selection-bg: rgba(56, 189, 248, 0.2);
}
body.theme-teradata {
    --md-sys-color-background: #1e252b; --md-sys-color-surface: #2d3741;
    --md-sys-color-surface-container: #3c4854; --md-sys-color-surface-container-high: #4f5f6d;
    --md-sys-color-primary: #F37423; --md-sys-color-on-primary: #FFFFFF;
    --md-sys-color-secondary-container: #334155; --md-sys-color-on-surface: #ffffff;
    --md-sys-color-outline: #5c6f7f; --md-sys-color-error: #ef4444; --cmd-bg: #151a1f;
    --accent-green: #22c55e; --selection-bg: rgba(243, 116, 35, 0.15);
}

/* --- THEME: GOD OF WAR (SPARTAN) --- */
body.theme-spartan {
    /* Fondo: Tonos piedra oscura y ceniza volcánica */
    --md-sys-color-background: #120F0E; 
    --md-sys-color-surface: #1C1917;
    
    /* Contenedores: Marrón oscuro desaturado (Cuero viejo) */
    --md-sys-color-surface-container: #26211F; 
    --md-sys-color-surface-container-high: #332B29;
    
    /* Primario: Rojo Espartano (La marca de Kratos) */
    --md-sys-color-primary: #E53935; 
    --md-sys-color-on-primary: #FFFFFF;
    
    /* Secundario: Bronce nórdico / Cuero */
    --md-sys-color-secondary-container: #4E342E; 
    
    /* Textos: Blanco Ceniza (Piel de Kratos) y Gris Bronce */
    --md-sys-color-on-surface: #EFEBE9; 
    --md-sys-color-on-surface-variant: #BCAAA4; 
    
    /* Bordes y Detalles */
    --md-sys-color-outline: #5D4037; 
    --md-sys-color-error: #C62828; 
    
    /* Código y Acentos */
    --cmd-bg: #0A0908;       /* Negro profundo */
    --accent-green: #8BC34A; /* Verde "Orbe de Salud" */
    
    /* Selección */
    --selection-bg: rgba(229, 57, 53, 0.25); /* Resplandor rojo */
}

/* --- THEME: NINTENDO 64 (64-BIT ERA) --- */
body.theme-n64 {
    /* Fondo: Gris Carbón Profundo (Carcasa de la consola) */
    --md-sys-color-background: #18181A; 
    --md-sys-color-surface: #222224;
    
    /* Contenedores: Gris Plástico Mate (Cartucho / Expansion Pak) */
    --md-sys-color-surface-container: #2D2D30; 
    --md-sys-color-surface-container-high: #3A3A3E;
    
    /* Primario: Azul Vibrante (Botón A - Acción principal) */
    --md-sys-color-primary: #0050B5; 
    --md-sys-color-on-primary: #FFFFFF;
    
    /* Secundario: Verde (Botón B - Acentos secundarios) */
    --md-sys-color-secondary-container: #009640; 
    
    /* Textos: Gris Claro (Lectura cómoda sobre fondo oscuro) */
    --md-sys-color-on-surface: #E0E0E0; 
    --md-sys-color-on-surface-variant: #9E9E9E; 
    
    /* Bordes: Gris Medio (Ranuras de ventilación) */
    --md-sys-color-outline: #555555; 
    --md-sys-color-error: #D32F2F; /* Rojo (Botón Start) */
    
    /* Terminal: Negro profundo con texto Amarillo (Botones C) */
    --cmd-bg: #0A0A0A;       
    --accent-green: #FFC600; /* El amarillo de los botones C resalta genial */
    
    /* Selección: Azul translúcido */
    --selection-bg: rgba(0, 80, 181, 0.3);
}

/* --- THEME: XBOX ONE (CONSOLE GREEN) --- */
body.theme-xbox {
    /* Fondo: Negro Dashboard (Casi absoluto para resaltar los colores) */
    --md-sys-color-background: #101010; 
    --md-sys-color-surface: #1F1F1F;
    
    /* Contenedores: Gris Oscuro "Tile" (Mosaicos de la interfaz) */
    --md-sys-color-surface-container: #2B2B2B; 
    --md-sys-color-surface-container-high: #363636;
    
    /* Primario: Xbox Green Oficial */
    --md-sys-color-primary: #107C10; 
    --md-sys-color-on-primary: #FFFFFF;
    
    /* Secundario: Gris Medio (Elementos inactivos) */
    --md-sys-color-secondary-container: #3A3A3A; 
    
    /* Textos: Blanco Puro (Alto contraste estilo TV) */
    --md-sys-color-on-surface: #FFFFFF; 
    --md-sys-color-on-surface-variant: #A0A0A0; 
    
    /* Bordes: Verde sutil para definir áreas */
    --md-sys-color-outline: #2D4A2D; 
    --md-sys-color-error: #E51C23; 
    
    /* Terminal: Negro puro con texto Verde Neón (Estilo Hacker/Console) */
    --cmd-bg: #000000;       
    --accent-green: #52D017; /* Un verde más brillante para leer código */
    
    /* Selección: Verde translúcido */
    --selection-bg: rgba(16, 124, 16, 0.3);
}

/* --- THEME: FENDER VINTAGE (TWEED & RELIC) --- */
body.theme-fender {
    /* Background: Lacquered Tweed (Golden/Amber aged) */
    --md-sys-color-background: #D5A859; 
    --md-sys-color-surface: #E3B96A;
    
    /* Containers: Tobacco Burst (Dark brown, almost black, like the edges of a Sunburst) */
    --md-sys-color-surface-container: #3E2723; 
    --md-sys-color-surface-container-high: #4E342E;
    
    /* Primary: Fiesta Red (Classic custom color) */
    --md-sys-color-primary: #D32F2F; 
    --md-sys-color-on-primary: #FFFFFF;
    
    /* Secondary: Chrome/Nickel (Aged hardware) */
    --md-sys-color-secondary-container: #90A4AE; 
    
    /* Text: Cream/Aged White (Like old pickguards) on dark backgrounds */
    --md-sys-color-on-surface: #3E2723; /* Dark Brown on Tweed */
    --md-sys-color-on-surface-variant: #5D4037;
    
    /* Overrides for text inside dark containers (commands/folders) */
    /* This requires a small trick: text on dark surfaces needs to be light */
    
    /* Borders: Oxblood (Like the grill cloth of some amps) */
    --md-sys-color-outline: #5D4037; 
    --md-sys-color-error: #B71C1C; 
    
    /* Terminal: Dark Tube Amp Grill */
    --cmd-bg: #261815;       
    --accent-green: #FFD54F; /* Amber Jewel Light (Power indicator) */
    
    /* Selection: Golden Nitrocellulose */
    --selection-bg: rgba(213, 168, 89, 0.4);
}

/* Specific adjustment for this theme: Text inside dark cards (Folders/Commands) needs to be light */
body.theme-fender .node-item {
    color: #F5F5F5 !important; /* Cream text for readability on dark brown */
}
body.theme-fender .folder-header {
    color: #3E2723 !important; /* Dark text on the light background */
}

/* --- THEME: TURQUOISE (DEEP OCEAN) --- */
body.theme-turquoise {
    /* Fondo: Pizarra profunda (Dark Slate / Deep Petrol) */
    --md-sys-color-background: #0F181A; 
    --md-sys-color-surface: #162225;
    
    /* Contenedores: Teal oscuro */
    --md-sys-color-surface-container: #1E2D32; 
    --md-sys-color-surface-container-high: #26383E;
    
    /* Primario: Turquesa Vibrante */
    --md-sys-color-primary: #00E5FF; 
    --md-sys-color-on-primary: #000000; /* Texto negro sobre turquesa para contraste */
    
    /* Secundario: Cian suave */
    --md-sys-color-secondary-container: #4DD0E1; 
    
    /* Textos: Blanco Hielo y Gris Azulado */
    --md-sys-color-on-surface: #E0F7FA; 
    --md-sys-color-on-surface-variant: #B2EBF2; 
    
    /* Bordes: Teal medio */
    --md-sys-color-outline: #00838F; 
    --md-sys-color-error: #FF5252; 
    
    /* Terminal: Abismo marino */
    --cmd-bg: #0A1012;       
    --accent-green: #18FFFF; /* Cian Eléctrico para el código */
    
    /* Selección: Turquesa translúcido */
    --selection-bg: rgba(0, 229, 255, 0.2);
}

/* =========================================
   ELEMENTOS DE INTERFAZ
   ========================================= */
body {
    background-color: var(--md-sys-color-background); color: var(--md-sys-color-on-surface);
    font-family: var(--font-ui); transition: background-color 0.3s ease, color 0.3s ease;
}
.header-row { display: flex; justify-content: space-between; align-items: center; }
.app-title { font-family: var(--font-code); font-weight: 700; color: var(--md-sys-color-primary); font-size: 1.1rem; }
.action-buttons { display: flex; gap: 4px; align-items: center; }
.separator { width: 1px; height: 18px; background-color: var(--md-sys-color-outline); margin: 0 4px; opacity: 0.3; }
.icon-btn {
    background: transparent; border: none; cursor: pointer; color: var(--md-sys-color-on-surface-variant);
    padding: 6px; border-radius: var(--radius-sm); transition: all 0.2s ease; font-size: 1.1rem;
    display: flex; align-items: center; justify-content: center;
}
.icon-btn:hover { background-color: var(--md-sys-color-surface-container-high); color: var(--md-sys-color-on-surface); }
.icon-btn.danger:hover { background-color: var(--md-sys-color-error); color: #380d0d; }

.search-row { position: relative; width: 100%; margin-top: 10px; }
.search-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: var(--md-sys-color-outline); font-size: 0.9rem; }
input[type="text"]#search-input {
    width: 100%; padding: 8px 12px 8px 34px;
    background-color: var(--md-sys-color-surface-container); border: 1px solid transparent;
    border-radius: var(--radius-pill); color: var(--md-sys-color-on-surface); font-size: 0.9rem; box-sizing: border-box;
}
input[type="text"]#search-input:focus {
    outline: none; border-color: var(--md-sys-color-primary); background-color: var(--md-sys-color-surface-container-high);
}

.section-container {
    background-color: var(--md-sys-color-surface); border: 1px solid var(--md-sys-color-surface-container-high);
    border-radius: var(--radius-md); overflow: hidden; margin-bottom: 12px;
}
.section-header {
    padding: 8px 12px; background-color: var(--md-sys-color-surface-container);
    font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px;
    color: var(--md-sys-color-on-surface-variant); user-select: none; cursor: pointer;
    display: flex; justify-content: space-between; align-items: center;
}
.section-header:hover { background-color: var(--md-sys-color-surface-container-high); color: var(--md-sys-color-primary); }
.section-content { padding: 4px 0; }
.section-content.collapsed { display: none; }

/* =========================================
   ELEMENTOS DEL ÁRBOL
   ========================================= */
.tree-item {
    padding: 4px 8px; margin: 2px 0; border-radius: var(--radius-sm);
    cursor: pointer; transition: background 0.15s, border 0.15s, box-shadow 0.15s, opacity 0.2s;
    border: 2px solid transparent; /* Bordes base */
    display: flex; flex-direction: column;
}
.tree-item:hover { background-color: var(--md-sys-color-surface-container-high); }
.item-header { display: flex; align-items: center; font-size: 0.85rem; padding: 4px; color: var(--md-sys-color-on-surface); }
.tag-badge {
    /* Tipografía técnica y legible */
    font-size: 10px; 
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    
    /* Forma de Píldora V3 */
    padding: 2px 10px; 
    border-radius: 20px; /* Más redondeado para el look moderno */
    margin-left: 6px; /* Espacio entre badges si hay varios */
    
    /* Efecto de profundidad sutil (Glassmorphism) */
    background-color: var(--md-sys-color-primary-container, rgba(66, 135, 245, 0.1)); 
    color: var(--md-sys-color-primary, #4287f5);
    border: 1px solid rgba(66, 135, 245, 0.2);
    
    /* Animación fluida */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    display: inline-flex;
    align-items: center;
    cursor: default;
}

/* Interacción: Los tags resaltan cuando interactúas con el comando */
.tree-item:hover .tag-badge {
    background-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary, #ffffff);
    border-color: transparent;
    transform: translateY(-1px); /* Sutil levantamiento */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

/* DRAG & DROP & CUT STATE */
.tree-item.dragging { opacity: 0.4; border: 2px dashed var(--md-sys-color-primary); }
.tree-item.drop-inside {
    background-color: var(--selection-bg) !important;
    border: 2px solid var(--md-sys-color-primary) !important;
    border-radius: var(--radius-sm);
    box-shadow: 0 0 15px var(--md-sys-color-primary);
    z-index: 10;
}
/* Estado visual de "Cortado" */
.tree-item.cut-state {
    opacity: 0.5;
    border: 1px dashed var(--md-sys-color-error) !important;
    background-color: rgba(255,0,0,0.05);
}

/* COMANDOS Y SINTAXIS */



.sh-keyword { color: #ff7b72; font-weight: bold; }
.sh-string { color: #a5d6ff; }
.sh-flag { color: #79c0ff; font-style: italic; }
.sh-comment { color: #8b949e; }
body.theme-light .sh-keyword { color: #d73a49; }
body.theme-light .sh-string { color: #032f62; }
body.theme-hacker .sh-keyword { color: #fff; }
body.theme-hacker .sh-string { color: #0f0; opacity: 0.8; }





/* ANIMACIONES */
.folder-wrapper { display: grid; grid-template-rows: 0fr; transition: grid-template-rows 0.25s ease-out; }
.folder-wrapper.open { grid-template-rows: 1fr; }
.folder-inner { overflow: hidden; padding-left: 14px; border-left: 1px solid var(--md-sys-color-surface-container-high); }

/* ==========================================================================
   CONTEXT MENU V3 (ESTILO CYBER-GLASS & ELEVACIÓN)
   ========================================================================== */

.context-menu {
    position: fixed;
    /* Elevación máxima para estar por encima de las tarjetas (999) */
    z-index: 10000; 
    min-width: 220px;
    padding: 6px;
    
    /* Efecto Vidrio Esmerilado (Glassmorphism) */
    background: rgba(30, 41, 59, 0.7) !important; 
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    
    /* Bordes Finos y Definidos */
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px; /* Consistencia con las tarjetas de comandos */
    
    /* Sombra Profunda para generar separación */
    box-shadow: 0 10px 35px rgba(0, 0, 0, 0.6), 
                0 0 0 1px rgba(255, 255, 255, 0.05);
    
    animation: menuFadeIn 0.12s ease-out;
}

.ctx-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    border-radius: 8px;
    
    font-size: 13px;
    font-weight: 500;
    color: var(--md-sys-color-on-surface);
    
    cursor: pointer;
    transition: all 0.2s ease;
}

/* Interacción de Selección */
.ctx-item:hover {
    background: var(--md-sys-color-primary-container, rgba(66, 135, 245, 0.2));
    color: var(--md-sys-color-primary);
}

/* Acción de Peligro (Borrar) */
.ctx-item.danger:hover {
    background: rgba(239, 68, 68, 0.15) !important;
    color: #ef4444 !important;
}

/* PALETA DE COLORES INTEGRADA */
.color-palette {
    display: flex;
    gap: 10px;
    padding: 10px;
    margin-top: 4px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    justify-content: center;
}

.color-dot {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid rgba(255, 255, 255, 0.1);
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.color-dot:hover {
    transform: scale(1.3);
    border-color: white;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

/* Animación de apertura */
@keyframes menuFadeIn {
    from { opacity: 0; transform: translateY(-5px) scale(0.98); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}
/* --- INICIO BLOQUE ICONOS (AJUSTADO) --- */

.icon-selector {
    display: grid;
    grid-template-columns: repeat(3, 1fr);  /* 3 columnas forzadas */
    gap: 6px;                               /* Espacio entre botones */
    padding: 8px 0;                         /* Padding vertical solamente */
    width: 100%;
    box-sizing: border-box;
}

.icon-option {
    font-size: 0.75rem;
    cursor: pointer;
    padding: 6px 2px;
    border-radius: 4px;
    border: 1px solid transparent;
    color: var(--md-sys-color-on-surface);
    background-color: var(--md-sys-color-surface-container);
    
    /* Asegurar centrado y evitar desbordes */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    white-space: nowrap;      /* Evita que el texto se parta en dos líneas */
    overflow: hidden;         /* Recorta si es muy largo */
    
    transition: transform 0.1s, background-color 0.2s;
}

.icon-option:hover {
    background-color: var(--md-sys-color-surface-container-high);
    border-color: var(--md-sys-color-outline);
    transform: scale(1.05);
}

/* --- FIN BLOQUE ICONOS --- */

.modal-overlay, .settings-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.7); backdrop-filter: blur(3px);
    display: flex; justify-content: center; align-items: center; z-index: 5000;
}
.modal-box, .settings-box {
    background: var(--md-sys-color-surface); width: 90%; max-width: 340px;
    border-radius: var(--radius-lg); border: 1px solid var(--md-sys-color-surface-container-high);
    padding: 24px; box-shadow: 0 12px 40px rgba(0,0,0,0.6);
}
#username-input, #gh-token-input, #theme-selector {
    height: 42px !important; width: 100% !important; padding: 0 12px !important;
    background-color: var(--md-sys-color-surface-container-high) !important;
    color: var(--md-sys-color-on-surface) !important;
    border: 1px solid var(--md-sys-color-outline) !important;
    border-radius: var(--radius-sm) !important; box-sizing: border-box !important; margin-bottom: 10px;
}
.btn-secondary, .btn-gh {
    border: none; padding: 8px 16px; border-radius: var(--radius-sm); cursor: pointer; font-weight: 500; width: 100%;
}
.btn-secondary { background: var(--md-sys-color-secondary-container); color: var(--md-sys-color-on-surface); }
.btn-gh.upload { background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); }
.btn-gh.download { background-color: var(--md-sys-color-surface-container-high); color: var(--md-sys-color-primary); border: 1px solid var(--md-sys-color-primary); }
.btn-gh:disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }

/* FIX CRÍTICO: Mensajes siempre encima (Z-Index 20000) */
.status-msg {
    position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
    background-color: var(--md-sys-color-on-surface); color: var(--md-sys-color-surface);
    padding: 12px 24px; border-radius: var(--radius-pill); font-weight: 500;
    z-index: 20000; /* Prioridad absoluta */
    box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    text-align: center;
    min-width: 200px;
}
.hidden { display: none !important; }



/* --- CORRECCIÓN DEFINITIVA: ALINEACIÓN DE SETTINGS --- */

/* 1. INPUTS (TextBox: Nombre y Token) */
#username-input, 
#gh-token-input {
    /* Dimensiones */
    height: 40px !important;
    box-sizing: border-box !important;
    
    /* Comportamiento Flex */
    flex: 1 1 auto !important;         /* Intenta crecer... */
    width: auto !important;            
    
    /* --- AQUÍ CONTROLAS EL LARGO DEL TEXTBOX --- */
    max-width: 250px !important;       /* ...pero detente al llegar a 250px */
    min-width: 100px !important;       /* No seas más pequeño que 100px */
    /* ------------------------------------------- */
    
    /* Estética */
    margin: 0 !important;
    padding: 0 10px !important;
    border: 1px solid var(--md-sys-color-outline) !important;
    border-radius: 4px !important;
    background-color: var(--md-sys-color-surface-container-high) !important;
    color: var(--md-sys-color-on-surface) !important;
}

/* 2. BOTONES SAVE (Botón lateral) */
#btn-save-username, 
#btn-save-token {
    /* Dimensiones */
    height: 40px !important;           /* Idéntica altura que el input */
    box-sizing: border-box !important; 
    
    /* Comportamiento Flex */
    flex: 0 0 auto !important;         /* No te estires ni te encojas */
    width: auto !important;            
    
    /* Tamaño fijo y seguro para el botón */
    min-width: 167px !important;        
    
    /* Estética */
    margin: 0 !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
}

/* --- AJUSTE FINAL: BOTÓN CLOSE (Cerrar Configuración) --- */

#btn-close-settings {
    /* Forzamos la misma altura que los demás elementos */
    height: 40px !important;
    min-height: 40px !important;
    
    /* Aseguramos que el borde se cuente dentro del tamaño */
    box-sizing: border-box !important;
    
    /* Centrado del texto */
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    
    /* Opcional: Si quieres que ocupe todo el ancho disponible */
    width: 100% !important; 
    
    cursor: pointer !important;
}

/* --- FIX FINAL: EFECTO HOVER EN BOTONES DE CONFIGURACIÓN --- */

/* 1. Preparamos la animación suave */
#btn-save-username, 
#btn-save-token, 
#btn-close-settings,
#btn-gh-push,
#btn-gh-pull,
#btn-gh-fetch {
    transition: all 0.2s ease !important;
}

/* 2. Definimos qué pasa al poner el MOUSE ENCIMA (:hover) */
#btn-save-username:hover, 
#btn-save-token:hover, 
#btn-close-settings:hover,
#btn-gh-push:hover,
#btn-gh-pull:hover,
#btn-gh-fetch:hover {
    /* Se iluminan con el color primario del tema actual (Turquesa, Rojo, Verde, etc.) */
    background-color: var(--md-sys-color-primary) !important;
    color: var(--md-sys-color-on-primary) !important;
    
    /* Pequeña elevación y sombra para dar sensación de "botón" */
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
    
    cursor: pointer !important;
}

/* 3. Definimos qué pasa al hacer CLICK (:active) */
#btn-save-username:active, 
#btn-save-token:active, 
#btn-close-settings:active,
#btn-gh-push:active,
#btn-gh-pull:active,
#btn-gh-fetch:active {
    transform: translateY(0) !important; /* Vuelve a bajar */
    box-shadow: none !important;
}

/* --- FIX FINAL: ANIMACIÓN PUSH/FETCH (IDs CORRECTOS) --- */

/* 1. Configuración Base para btn-sync-upload y btn-sync-download */
#btn-sync-upload,
#btn-sync-download {
    transition: all 0.2s ease !important;
    /* Forzamos que parezcan activos para probar, o deja que JS lo controle */
}

/* 2. Efecto HOVER (Solo si el botón NO está disabled) */
#btn-sync-upload:not(:disabled):hover,
#btn-sync-download:not(:disabled):hover {
    /* Color Primario del Tema */
    background-color: var(--md-sys-color-primary) !important;
    color: var(--md-sys-color-on-primary) !important;
    
    /* Efecto visual */
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
    cursor: pointer !important;
}

/* 3. Efecto ACTIVE (Clic) */
#btn-sync-upload:not(:disabled):active,
#btn-sync-download:not(:disabled):active {
    transform: translateY(0) !important;
    box-shadow: none !important;
}

/* --- FIX DEFINITIVO (LISTA BLANCA) --- */

/* 1. REGLA SUPREMA: Ocultar TODOS los <hr> dentro del menú por defecto */
#context-menu hr {
    display: none !important;
    border: none !important;
    margin: 0 !important;
    height: 0 !important;
}

/* 2. EXCEPCIÓN: Mostrar SOLO los que tienen la clase "ctx-hr" */
#context-menu hr.ctx-hr {
    display: block !important;
    height: 1px !important;
    margin: 5px 0 !important;
    border: 0 !important;
    
    /* CAMBIO: Color más intenso y sin transparencia */
    border-top: 1px solid #888 !important; /* Gris sólido y visible */
    opacity: 1 !important; /* 100% visible (antes 0.5) */
}

/* 3. Limpieza de contenedores para evitar bordes fantasma */
#ctx-folder-section, 
#ctx-cmd-section {
    border: none !important;
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
}

/* --- FIX FINAL SUPREMO: RESPETAR LA CLASE HIDDEN --- */

/* 1. Soluciona el conflicto: Si el JS agrega la clase 'hidden', 
      esta regla fuerza a ocultar la línea, ganándole al 'display: block !important' anterior. */
#context-menu hr.ctx-hr.hidden {
    display: none !important;
    height: 0 !important;
    margin: 0 !important;
    border: none !important;
}

/* ==========================================================================
   ESTILOS DEL MODAL DINÁMICO (REPARADO, CENTRADO Y CON VISTA PREVIA)
   ========================================================================== */

/* 1. EL FONDO (Overlay) - Garantiza el centrado absoluto */
.modal-overlay {
    position: fixed;
    top: 0; 
    left: 0; 
    width: 100vw; 
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.7); /* Fondo oscuro */
    backdrop-filter: blur(3px); /* Efecto borroso elegante */
    z-index: 99999; /* Siempre encima de todo */
    
    /* MAGIA FLEXBOX PARA CENTRAR (Con !important para forzarlo) */
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    
    /* Transiciones */
    opacity: 1;
    transition: opacity 0.2s ease;
}

/* Estado oculto */
.modal-overlay.hidden {
    display: none !important;
    opacity: 0;
    pointer-events: none;
}

/* 2. LA CAJA DEL MODAL */
.modal-content {
    background-color: var(--md-sys-color-surface);
    color: var(--md-sys-color-on-surface);
    width: 90%;
    max-width: 380px; /* Ancho ideal */
    border-radius: 16px;
    padding: 24px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.5);
    border: 1px solid var(--md-sys-color-outline-variant);
    
    display: flex; 
    flex-direction: column; 
    gap: 16px;
    position: relative; 
}

/* 3. VISTA PREVIA DEL COMANDO (Estilo Código) */
.cmd-preview-box {
    background-color: #2b2b2b; /* Fondo oscuro tipo terminal */
    color: #a5d6ff; /* Texto azul claro */
    font-family: 'Consolas', 'Roboto Mono', monospace;
    font-size: 11px;
    padding: 12px;
    border-radius: 8px;
    border-left: 4px solid var(--md-sys-color-primary);
    
    white-space: pre-wrap;
    word-break: break-all;
    line-height: 1.4;
    max-height: 80px;
    overflow-y: auto;
}

/* 4. INPUTS */
#dynamic-form-container {
    display: flex; flex-direction: column; gap: 12px;
    max-height: 50vh; overflow-y: auto;
}

.var-group {
    display: flex; flex-direction: column; gap: 4px;
}

.modal-input, .dynamic-input-field {
    background: var(--md-sys-color-surface-variant);
    border: 1px solid var(--md-sys-color-outline);
    border-radius: 8px;
    padding: 12px;
    color: var(--md-sys-color-on-surface);
    font-size: 13px;
    width: 100%;
    box-sizing: border-box;
}
.modal-input:focus, .dynamic-input-field:focus {
    border-color: var(--md-sys-color-primary);
    outline: 2px solid var(--md-sys-color-primary-container);
}

/* 5. BOTONES SIMÉTRICOS */
.modal-actions {
    display: flex; 
    gap: 12px; 
    margin-top: 8px;
    border-top: none; /* Quitamos bordes extras si los hubiera */
}

.btn-primary-modal, .btn-secondary-modal {
    flex: 1; /* Ambos ocupan 50% exacto */
    padding: 12px 0;
    border-radius: 8px;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    border: none;
    display: flex; justify-content: center; align-items: center;
}

.btn-primary-modal {
    background-color: var(--md-sys-color-primary);
    color: var(--md-sys-color-on-primary);
}
.btn-primary-modal:hover { filter: brightness(1.1); }

.btn-secondary-modal {
    background-color: transparent;
    color: var(--md-sys-color-on-surface);
    border: 1px solid var(--md-sys-color-outline);
}
.btn-secondary-modal:hover { background-color: var(--md-sys-color-surface-variant); }

/* --- WATERMARK DE AUTOR --- */
.app-watermark {
    text-align: center;
    font-size: 11px;
    font-weight: 500;
    
    /* Color sutil (adaptable a tema claro/oscuro si usas variables) */
    color: var(--md-sys-color-outline, #888); 
    
    opacity: 0.6; /* Transparencia para que no distraiga */
    margin-top: 30px; /* Separación del resto de controles */
    margin-bottom: 10px;
    letter-spacing: 0.5px; /* Un poco de aire entre letras */
    font-family: 'Roboto', sans-serif; /* O la fuente que uses en tu app */
    
    /* Opcional: Evitar que el usuario lo seleccione por accidente */
    user-select: none;
    cursor: default;
}

/* --- CONTENEDORES DE BOTONES MINIMALISTAS --- */
.header-btn {
    background: transparent !important; /* Elimina el fondo blanco */
    border: none !important;            /* Elimina bordes */
    padding: 8px !important;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: inherit; /* Para que herede el color del tema */
    transition: all 0.2s ease;
}

/* --- DIVISORES (Las líneas verticales | entre iconos) --- */
.header-separator {
    width: 1px;
    height: 20px;
    background-color: var(--md-sys-color-outline-variant, rgba(255,255,255,0.1));
    margin: 0 4px;
    opacity: 0.5;
}

/* --- REFUERZO PARA LOS ICONOS --- */
.header-icon {
    width: 20px;
    height: 20px;
    fill: none !important; /* Asegura que no haya rellenos */
    stroke: currentColor !important; /* Color dinámico */
    stroke-width: 1.5px !important; /* Línea fina */
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.header-btn:hover .header-icon {
    opacity: 1;
    transform: scale(1.1);
}

/* --- 1. ICONOS Y BOTONES DEL HEADER (MANTENER) --- */
.header-btn {
    background: transparent !important;
    border: none !important;
    padding: 8px !important;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: inherit;
    transition: all 0.2s ease;
}

.header-separator {
    width: 1px;
    height: 20px;
    background-color: var(--md-sys-color-outline-variant, rgba(255,255,255,0.1));
    margin: 0 4px;
    opacity: 0.5;
}

.header-icon {
    width: 20px;
    height: 20px;
    fill: none !important;
    stroke: currentColor !important;
    stroke-width: 1.5px !important;
    stroke-linecap: round;
    stroke-linejoin: round;
    opacity: 0.7;
    transition: opacity 0.2s;
}

/* --- CONTENEDOR DE BÚSQUEDA V3 (OPTIMIZADO) --- */
.search-wrapper {
    display: flex;
    align-items: center;
    background: rgba(15, 23, 42, 0.4); 
    /* El borde ahora sigue el color primario del tema */
    border: 1px solid var(--md-sys-color-primary, rgba(66, 135, 245, 0.2)); 
    border-radius: 10px;
    padding: 2px 12px; /* Reducido un poco el padding lateral */
    margin: 12px 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Glow dinámico basado en el tema */
    box-shadow: 0 0 10px var(--md-sys-color-primary-container, rgba(66, 135, 245, 0.1));
}

/* --- AJUSTE DE TEMA CLARO PARA SEARCH BOX EN CMDVAULT --- */

/* Aplicamos los cambios solo cuando la clase .theme-light está activa */
.theme-light .search-wrapper {
    /* Fondo claro translúcido (estilo frosted glass) */
    background: rgba(255, 255, 255, 0.7) !important;
    
    /* Borde sutil para que no se pierda en el fondo claro */
    border: 1px solid rgba(0, 0, 0, 0.1) !important;
}

.theme-light #search-input {
    /* Texto oscuro para máxima legibilidad */
    color: #1e293b !important; 
}

.theme-light .search-icon-v3 {
    /* Mantenemos el color primario del tema para el icono */
    color: var(--md-sys-color-primary) !important;
    opacity: 0.8 !important;
}

.theme-light #search-input::placeholder {
    /* Placeholder en un tono grisáceo suave */
    color: rgba(30, 41, 59, 0.5) !important;
}

/* Icono de Lupa - Parámetro de espacio ajustado */
.search-icon-v3 {
    width: 14px; /* Un poco más pequeña para elegancia */
    height: 14px;
    color: var(--md-sys-color-primary); /* Color dinámico */
    margin-right: 1px; /* ANTES: 12px. Este es el parámetro que ajusta la cercanía */
    flex-shrink: 0;
    opacity: 0.6;
}

/* Input de Texto - Contraste suavizado */
#search-input {
    flex: 1;
    background: transparent !important;
    border: none !important;
    /* Usamos el color del tema con opacidad para suavizar el contraste */
    color: var(--md-sys-color-on-surface, #e2e8f0); 
    font-size: 13px;
    padding: 8px 0;
    outline: none !important;
    opacity: 0.9; /* Evita el blanco puro hiriente */
}

#search-input::placeholder {
    color: var(--md-sys-color-on-surface-variant, rgba(255, 255, 255, 0.25));
    font-weight: 300;
}

/* --- ESTADO FOCUS DINÁMICO --- */
.search-wrapper:focus-within {
    background: rgba(15, 23, 42, 0.6);
    /* Resplandor más intenso pero fiel al tema */
    border-color: var(--md-sys-color-primary);
    box-shadow: 0 0 10px var(--md-sys-color-primary, rgba(66, 135, 245, 0.4));
    transform: translateY(-1px);
}

/* --- PULIDO FINAL V3: HIGHLIGHT & FOCUS --- */

/* REEMPLAZA TU BLOQUE .search-highlight ACTUAL POR ESTE */

.search-highlight {
    /* Fondo Ámbar Translúcido: Destaca sin tapar */
    background-color: rgba(255, 185, 0, 0.35) !important;
    
    /* Texto Blanco Puro: Máximo contraste sobre el ámbar */
    color: #ffffff !important;
    
    /* Pequeña sombra al texto para que se lea mejor */
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.4);
    
    font-weight: 700;
    border-radius: 4px; /* Un poco más redondeado */
    padding: 1px 4px; /* Un poco más de aire a los lados */
    
    /* Sutil resplandor dorado */
    box-shadow: 0 0 10px rgba(255, 185, 0, 0.2);
}

/* Mejora del Focus en el wrapper que ya tienes */
.search-wrapper:focus-within {
    background: rgba(30, 41, 59, 0.7) !important; /* Más oscuro al enfocar */
    border-color: var(--md-sys-color-primary) !important;
    /* Resplandor (Glow) más definido */
    box-shadow: 0 0 0 3px rgba(66, 135, 245, 0.15), 
                0 4px 12px rgba(0, 0, 0, 0.4);
    transform: translateY(-1px);
}

/* --- ICONOS DE CARPETA V3 --- */
.folder-icon-v3 {
    width: 18px;
    height: 18px;
    fill: none !important;
    stroke: currentColor !important;
    stroke-width: 1.5px !important;
    stroke-linecap: round;
    stroke-linejoin: round;
    margin-right: 10px;
    vertical-align: middle;
    opacity: 0.8;
    transition: transform 0.2s ease;
}

/* Efecto al pasar el mouse sobre la fila de la carpeta */
.folder-item:hover .folder-icon-v3 {
    transform: scale(1.1);
    opacity: 1;
    color: var(--md-sys-color-primary);
}

/* --- ICONOS DE CARPETA V3 --- */
.folder-icon-v3 {
    width: 18px;
    height: 18px;
    fill: none !important;
    stroke: currentColor !important;
    stroke-width: 1.5px !important;
    stroke-linecap: round;
    stroke-linejoin: round;
    margin-right: 10px;
    vertical-align: middle;
    opacity: 0.8;
    transition: transform 0.2s ease;
}

/* Efecto al pasar el mouse sobre la fila de la carpeta */
.folder-item:hover .folder-icon-v3 {
    transform: scale(1.1);
    opacity: 1;
    color: var(--md-sys-color-primary);
}

/* ==========================================================================
   COMMAND CARDS V3 (ESTILO TARJETA FLOTANTE MINIMALISTA)
   ========================================================================== */

/* 1. EL CONTENEDOR PRINCIPAL (LA TARJETA) */
.cmd-wrapper {
    position: relative; /* Necesario para posicionar el botón de copia adentro */
    display: flex;
    flex-direction: column;
    
    /* Estilo "Cyber-Glass" */
    background: rgba(15, 23, 42, 0.3); /* Fondo oscuro muy translúcido */
    border: 1px solid var(--md-sys-color-outline-variant, rgba(255,255,255,0.08)); /* Borde casi invisible */
    border-radius: 12px; /* Esquinas muy redondeadas (estilo moderno) */
    
    /* Espaciado y Márgenes */
    margin: 8px 0 8px 12px; /* Alejado del borde izquierdo para jerarquía */
    padding: 12px 14px; /* Padding interno cómodo para que el texto respire */
    
    /* Transición suave para el efecto hover */
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Efecto Hover: La tarjeta "despierta" */
.cmd-wrapper:hover {
    background: rgba(15, 23, 42, 0.5); /* Un poco más opaco */
    border-color: var(--md-sys-color-primary); /* El borde toma el color del tema */
    
    /* Resplandor suave dinámico (igual que el search box) */
    box-shadow: 0 0 12px var(--md-sys-color-primary-container, rgba(66, 135, 245, 0.15));
    
    transform: translateY(-1px); /* Sutil efecto de levitación */
}

/* 2. EL ÁREA DE CÓDIGO (TEXTO) */
/* 1. ESTADO BASE: Comando colapsado (una sola línea) */
.cmd-preview {
    background: transparent !important;
    border: none !important;
    font-family: 'Consolas', 'Roboto Mono', monospace;
    font-size: 12px;
    line-height: 1.5;
    color: var(--md-sys-color-on-surface, #e2e8f0);
    padding: 0 !important;
    margin: 0 !important;
    
    /* EL ESPACIO DE SEGURIDAD: 
       Evita que el texto tape el botón en la esquina */
    padding-right: 40px !important; 
    
    /* Efecto de recorte con puntos suspensivos (...) */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    
    cursor: copy;
    position: relative;
    z-index: 1; /* Por debajo del botón (que tiene 999) */
}

/* 2. ESTADO EXPANDIDO: Se activa al hacer clic en el chevron */
.cmd-preview.expanded {
    white-space: pre-wrap !important; /* Permite saltos de línea */
    word-break: break-all !important;  /* Evita que el texto se salga */
    overflow: visible !important;
    text-overflow: clip !important;
    max-height: none !important;       /* Permite que la tarjeta crezca */
}

/* Estilo para el resaltado de sintaxis (ajusta los colores si es necesario) */
.syntax-highlight {
    color: var(--md-sys-color-primary); /* Usa el color del tema para resaltar */
    font-weight: 500;
}

/* 3. EL BOTÓN DE COPIAR/EXPANDIR INTEGRADO */
.cmd-ctrl-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    
    display: flex;
    align-items: center;
    justify-content: center;
    
    width: 26px;
    height: 26px;
    border-radius: 6px;
    
    /* Fondo sutil que se mezcla con la tarjeta */
    background: rgba(255,255,255,0.03);
    color: var(--md-sys-color-on-surface-variant);
    
    cursor: pointer;
    transition: all 0.2s ease;
    opacity: 0.7;
    
    /* --- ESTA ES LA LÍNEA QUE ARREGLA EL CLIC --- */
    z-index: 10; /* Trae el botón al frente, sobre el texto */
}

.cmd-wrapper:hover .cmd-ctrl-btn {
    opacity: 1; /* Se ilumina junto con la tarjeta */
}

.cmd-ctrl-btn:hover {
    /* Resalte al pasar el mouse sobre el botón específico */
    background: var(--md-sys-color-primary-container);
    color: var(--md-sys-color-primary);
}

/* 4. COMPATIBILIDAD CON TEMA CLARO (Light Mode Fix) */
.theme-light .cmd-wrapper,
.light-mode .cmd-wrapper {
    background: rgba(255, 255, 255, 0.7) !important; /* Vidrio esmerilado claro */
    border-color: rgba(0, 0, 0, 0.08) !important;
}

.theme-light .cmd-wrapper:hover,
.light-mode .cmd-wrapper:hover {
    border-color: var(--md-sys-color-primary) !important;
}

.theme-light .cmd-preview,
.light-mode .cmd-preview {
    color: #1e293b !important; /* Texto oscuro para legibilidad */
}

.theme-light .cmd-ctrl-btn,
.light-mode .cmd-ctrl-btn {
    background: rgba(0, 0, 0, 0.04);
    color: rgba(0, 0, 0, 0.6);
}

.theme-light .search-highlight,
.light-mode .search-highlight {
    /* Texto oscuro para máxima legibilidad sobre el dorado */
    color: #1e293b !important; 
    
    /* Dorado con mayor opacidad para destacar en fondo blanco */
    background-color: rgba(255, 185, 0, 0.5) !important;
    
    text-shadow: none !important;
    font-weight: 700;
}

/* --- REFINAMIENTO DE CONTEXT MENU PARA MODO CLARO --- */

.theme-light .context-menu,
.light-mode .context-menu {
    /* Vidrio esmerilado blanco premium */
    background: rgba(255, 255, 255, 0.85) !important; 
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    
    border: 1px solid rgba(0, 0, 0, 0.08) !important;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
}

/* Encabezados internos (ej: "ICON TYPE") */
.theme-light .context-menu .menu-header {
    color: rgba(30, 41, 59, 0.6) !important;
    font-weight: 700;
    font-size: 11px;
}

.theme-light .ctx-item,
.light-mode .ctx-item {
    color: #1e293b !important; /* El color Slate que ya usamos */
    font-weight: 500;
}

.theme-light .ctx-item:hover,
.light-mode .ctx-item:hover {
    background: rgba(66, 135, 245, 0.1) !important;
    color: var(--md-sys-color-primary) !important;
}

.theme-light .icon-grid-btn {
    background: #ffffff !important;
    border: 1px solid rgba(0, 0, 0, 0.05) !important;
    color: #1e293b !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02) !important;
}

/* --- AJUSTE DE COLOR DE FLASH PARA TEMA CLARO --- */

.theme-light .copy-flash::after,
.light-mode .copy-flash::after {
    /* Usamos un Dorado/Ámbar para que destaque sobre el fondo blanco */
    background: #ffb900 !important; 
    
    /* En modo claro, un destello un poco más denso ayuda a la visibilidad */
    opacity: 0 !important;
}

.theme-light .copy-flash.active::after,
.light-mode .copy-flash.active::after {
    /* Opacidad de confirmación para el modo claro */
    opacity: 0.4 !important; 
}



/* BADGE ESPECIAL: PRECAUTION */
.tag-badge.precaution {
    /* Fondo ámbar translúcido y texto dorado */
    background-color: rgba(251, 191, 36, 0.1) !important; 
    color: #fbbf24 !important; 
    border-color: rgba(251, 191, 36, 0.3) !important;
}

/* Efecto Hover para Precaution */
.tree-item:hover .tag-badge.precaution {
    background-color: #fbbf24 !important;
    color: #1e293b !important; /* Texto oscuro para contraste */
    box-shadow: 0 0 10px rgba(251, 191, 36, 0.4);
}

/* --- REFINAMIENTO V3: FLASH DE ALTA VISIBILIDAD --- */

.copy-flash {
    position: relative !important;
    /* Asegura que nada se salga del contenedor durante el brillo */
    overflow: hidden !important; 
}

/* --- FIX DE VISIBILIDAD DE FLASH V3 --- */

.copy-flash::after {
    content: '' !important;
    position: absolute !important;
    top: 0; left: 0; right: 0; bottom: 0;
    
    /* VERDE ESMERALDA FORZADO */
    background: #22c55e !important; 
    
    opacity: 0 !important;
    pointer-events: none !important;
    
    /* POR ENCIMA DE TODO: Texto e iconos */
    z-index: 999999 !important; 
    
    transition: opacity 0.4s ease-out !important;
}

.copy-flash.active::after {
    /* Opacidad alta para confirmar que funciona */
    opacity: 0.6 !important; 
    transition: none !important;
}




/* --- EFECTO DE ÉXITO: ICONO CHECKMARK --- */

/* Suaviza la transición cuando el icono cambie */
.cmd-ctrl-btn {
    transition: all 0.2s ease-in-out !important;
}

/* --- MEJORA VISUAL DEL CHECKMARK (Surgical Fix) --- */

/* --- EFECTO "SUCCESS PULSE" V2 (Surgical & Professional) --- */

.copy-success {
    color: #22c55e !important;
    display: inline-block !important;
    position: relative !important;
    z-index: 1000000 !important;
    
    /* Efecto Pop + Rotación ligera (5 grados) para dinamismo */
    transform: scale(1.7) rotate(5deg) !important;
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
}

/* El Anillo de Pulso (Pseudo-elemento) */
.copy-success::after {
    content: '' !important;
    position: absolute !important;
    top: 50%; left: 50%;
    width: 20px; height: 20px;
    background: rgba(34, 197, 94, 0.6) !important;
    border-radius: 50% !important;
    transform: translate(-50%, -50%) scale(0);
    
    /* Disparamos la animación del anillo */
    animation: success-ripple 0.6s ease-out forwards !important;
    pointer-events: none !important;
}

@keyframes success-ripple {
    0% {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0.8;
    }
    100% {
        transform: translate(-50%, -50%) scale(2.5);
        opacity: 0;
    }
}

/* --- ANIMACIÓN DE CARPETAS OPCIÓN A --- */

.folder-content {
    overflow: hidden !important;
    /* Transición suave de altura y transparencia */
    transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out !important;
    max-height: 1000px; /* Un valor alto para permitir el despliegue */
    opacity: 1;
}

/* Estado cuando la carpeta está cerrada */
.folder-content.collapsed {
    max-height: 0 !important;
    opacity: 0 !important;
    pointer-events: none !important;
}

/* Rotación del icono para dar feedback de apertura */
.folder-icon-v3 {
    transition: transform 0.2s ease !important;
}

.item-header.collapsed .folder-icon-v3 {
    transform: rotate(-90deg);
}

/* --- OPCIÓN B: PALETA DE COLORES --- */
#ctx-colors {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding: 10px;
    background: var(--md-sys-color-surface-container-high);
    border-radius: 8px;
    margin-top: 5px;
}

.color-dot {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s, border 0.2s;
    border: 2px solid transparent;
}

.color-dot:hover {
    transform: scale(1.3);
    border-color: white;
}